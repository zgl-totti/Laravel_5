!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>列表页</title>
<link href="__STATIC__/css/style.css" rel="stylesheet" type="text/css" />
<link href="__STATIC__/css/select.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="__STATIC__/js/jQuery-1.8.2.min.js"></script>
<script type="text/javascript" src="__STATIC__/js/layer/layer.js"></script>
<script type="text/javascript" src="__STATIC__/js/jquery.idTabs.min.js"></script>
<script type="text/javascript" src="__STATIC__/js/select-ui.min.js"></script>
<script type="text/javascript">
$(document).ready(function(e) {
    $(".select1").uedSelect({
		width : 345			  
	});
	$(".select2").uedSelect({
		width : 167  
	});
	$(".select3").uedSelect({
		width : 100
	});
});
</script>
    <style>
        .message{float:left;}
        #page{float: right;}
        #page a,#page span{display: inline-block;width: 30px;height: 30px;line-height: 30px;text-align: center;border: 1px solid #ccc;}
        .current{background: #3EAFE0;color: #fff;  }
    </style>
</head>

<body>

	<div class="place">
    <span>位置：</span>
    <ul class="placeul">
    <li><a href="#">订单管理</a></li>
    <li><a href="#">待发货订单列表</a></li>
    </ul>
    </div>
    
    <div class="formbody">
    <div id="usual1" class="usual">
  	<div id="tab2" class="tabson">
        <form action="{:U('Order/index')}" method="get">
    <ul class="seachform">
        <li><label>收货人查询</label><input name="username" type="text" class="scinput" {$mes1==true?"value='$mes1'":'placeholder="收货人"'} /></li>
        <li><label>订单号查询</label><input name="ordersyn" type="text" class="scinput" {$mes2==true?"value='$mes2'":'placeholder="订单号"'} /></li>
        <li><label>手机号查询</label><input name="phone" type="text" class="scinput" {$mes3==true?"value='$mes3'":'placeholder="手机号"'} /></li>
        <li><input name="orderstatus" type="hidden" class="scinput" value="2"/></li>
        <li><label>&nbsp;</label><input name="" type="submit" class="scbtn" value="查询"/></li>
        <li><label>&nbsp;</label><input name="" type="button" class="scbtn plfh" value="批量发货"/></li>

    </ul>

    <table class="tablelist">
    	<thead>
    	<tr>
        <th><input type="checkbox" name="chk" onclick="show(this)"/></th>
        <th>编号</th>
        <th>订单号</th>
        <th>收货人</th>
        <th>手机号</th>
        <th>商品</th>
        <th>总价</th>
        <th>收货地址</th>
        <th>订单提交时间</th>
        <th>订单状态</th>
        <th>操作</th>
        </tr>
        </thead>
        <tbody>
        <foreach name="sele" item="val" key="k">
        <tr>
        <td name="{$val.id}"><input type="checkbox" name="chk1[]" class="lid{$k}"/></td>
        <td>{$firstRow+$k+1}</td>
        <td>{$val.ordersyn}</td>
        <td>{$val.username}</td>
        <td>{$val.phone}</td>
        <td>
            <volist name="val['cate']" id="va2">
                {:mb_substr($va2['goodsname'],0,10,'utf-8')}<b>(购买数量:{$va2['buynum']}x{$va2['gidprice']})</b><br>&nbsp;&nbsp;&nbsp;
            </volist>
        </td>
        <td>￥{$val.orderprice}</td>
        <td>{$val.ps}{$val.qs}{$val.ws}{$val.xyd}</td>
        <td>{:date('Y-m-d H:i:s',$val['addtime'])}</td>
        <td>{$val.adminopt}</td>
        <td>
            <a style="text-decoration: none;color: #002DFF;cursor:pointer" class="fh" name="{$val.id}">发货</a>
        </td>
        </tr>
        </foreach>
        </tbody>

    </table>
        </form>
        <div class="pagin">
            <div class="message">共<i class="blue">{$count}</i>条记录</div>
            <div id="page">{$page}</div>
        </div>
    
    </div>
	</div>
	<script type="text/javascript"> 
      $("#usual1 ul").idTabs(); 
    </script>
    
    <script type="text/javascript">
	$('.tablelist tbody tr:odd').addClass('odd');
	</script>
    
    </div>
</body>
<script>
    var xz=document.getElementsByName("chk1[]");
    $(function(){
        $('.fh').click(function(){
            j=$(this).attr("name");
            J=new Array();
            J[0]=j;
            $.post("{:U('Order/plfh')}",{id:J},function(res){
                 if(res.status==1){
                     layer.msg(res.info,{icon:6,time:1600},function(){
                         location="";
                     });
                 }else{
                     layer.msg(res.info,{icon:6,time:1600});
                 }
            })
        })
        $('.plfh').click(function(){
            //var xz=document.getElementsByName("chk1[]");
            S=new Array();
            for (var i = 0; i < xz.length; i++) {
                if(xz[i].checked) {
                    s = $(xz[i]).parent().attr('name');
                    S[i]=parseInt(s);

                }//alert(S);

            }
            $.post('{:U("Order/plfh")}',{id:S},function(res){
                if(res.status==1){
                    layer.msg(res.info,{icon:6,time:1600},function(){
                     location="";});
                }else{
                    layer.msg(res.info,{icon:2,time:1600});
                }
            })
        })
    })
    function show(obj) {
        for (var i = 0; i < xz.length; i++) {
            xz[i].checked = obj.checked;
        }
    }
</script>
</html>
